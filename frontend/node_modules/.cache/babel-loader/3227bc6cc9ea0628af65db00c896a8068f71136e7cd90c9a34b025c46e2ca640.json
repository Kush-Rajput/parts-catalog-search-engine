{"ast":null,"code":"import _objectSpread from\"C:/Users/admin/OneDrive - Impala Downtown/Documents/IDT - Web/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useMemo}from'react';import{FaCogs,FaTachometerAlt}from'react-icons/fa';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const categories=[{name:'Engines',icon:/*#__PURE__*/_jsx(FaCogs,{})},{name:'Service Parts',icon:/*#__PURE__*/_jsx(FaTachometerAlt,{})}];const apiRoutes={Engines:['/api/engines'],'Service Parts':['/api/sparkplugs','/api/filters']};export default function PartsCategoriesPage(){const[selectedCategory,setSelectedCategory]=useState(null);const[searchTerm,setSearchTerm]=useState('');const[debouncedSearchTerm,setDebouncedSearchTerm]=useState('');const[results,setResults]=useState([]);// Debounce search input\nuseEffect(()=>{const timeout=setTimeout(()=>{setDebouncedSearchTerm(searchTerm.trim());},300);return()=>clearTimeout(timeout);},[searchTerm]);// Fetch data only when category and search term are set\nuseEffect(()=>{const fetchData=async()=>{if(!selectedCategory||!debouncedSearchTerm)return;const urls=apiRoutes[selectedCategory];const params=new URLSearchParams({q:debouncedSearchTerm,page:1,page_size:100});try{const responses=await Promise.all(urls.map(url=>fetch(\"http://localhost:8000\".concat(url,\"?\").concat(params)).then(async res=>{if(!res.ok)throw new Error(\"Failed to fetch \".concat(url));const json=await res.json();return json.results.map(item=>_objectSpread(_objectSpread({},item),{},{sheet:item.sheet||url.split('/').pop()}));})));setResults(responses.flat());}catch(err){console.error('❌ Error fetching data:',err);setResults([]);}};fetchData();},[selectedCategory,debouncedSearchTerm]);const groupedResults=useMemo(()=>{return results.reduce((acc,item)=>{const group=item.sheet||'Other';acc[group]=acc[group]||[];acc[group].push(item);return acc;},{});},[results]);const renderCard=(item,index)=>{const label=Object.entries(item).find(_ref=>{let[k,v]=_ref;return v&&!['sheet','source','Qty','QTY','NOTE'].includes(k);});return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow hover:shadow-lg p-4 border border-gray-200\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-semibold text-blue-800 mb-2 text-md truncate\",children:label?label[1]:'Unnamed Part'}),/*#__PURE__*/_jsx(\"ul\",{className:\"text-sm text-gray-700 space-y-1\",children:Object.entries(item).map(_ref2=>{let[k,v]=_ref2;return k!=='sheet'&&k!=='source'&&v?/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsxs(\"strong\",{children:[k,\":\"]}),\" \",v]},k):null;})})]},index);};return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gradient-to-br from-gray-50 to-blue-100 py-10 px-6\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-4xl font-extrabold text-center mb-10 text-gray-900\",children:\"Browse Parts\"}),selectedCategory?/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-6xl mx-auto\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setSelectedCategory(null);setSearchTerm('');setResults([]);},className:\"text-blue-600 hover:text-blue-800 font-semibold mb-6 flex items-center gap-2\",children:\"\\u2190 Back to Categories\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search parts, model, make...\",value:searchTerm,onChange:e=>setSearchTerm(e.target.value),className:\"w-full mb-8 p-3 rounded-lg border border-gray-300 shadow focus:outline-none focus:ring-2 focus:ring-blue-400\"}),Object.keys(groupedResults).length?Object.entries(groupedResults).map(_ref3=>{let[sheet,items]=_ref3;return/*#__PURE__*/_jsxs(\"div\",{className:\"mb-10\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-blue-700 mb-4 border-b pb-1 capitalize\",children:sheet}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6\",children:items.map(renderCard)})]},sheet);}):debouncedSearchTerm&&/*#__PURE__*/_jsx(\"p\",{className:\"text-center text-gray-500 italic\",children:\"No matching parts found.\"})]}):/*#__PURE__*/_jsx(\"div\",{className:\"max-w-7xl mx-auto grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-6\",children:categories.map((cat,i)=>/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setSelectedCategory(cat.name),className:\"bg-white border border-gray-200 rounded-2xl p-6 flex flex-col items-center justify-center text-center shadow hover:shadow-lg transition hover:scale-105\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-4xl text-blue-500 mb-2\",children:cat.icon}),/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold text-sm text-gray-800\",children:cat.name})]},i))})]});}","map":{"version":3,"names":["React","useState","useEffect","useMemo","FaCogs","FaTachometerAlt","jsx","_jsx","jsxs","_jsxs","categories","name","icon","apiRoutes","Engines","PartsCategoriesPage","selectedCategory","setSelectedCategory","searchTerm","setSearchTerm","debouncedSearchTerm","setDebouncedSearchTerm","results","setResults","timeout","setTimeout","trim","clearTimeout","fetchData","urls","params","URLSearchParams","q","page","page_size","responses","Promise","all","map","url","fetch","concat","then","res","ok","Error","json","item","_objectSpread","sheet","split","pop","flat","err","console","error","groupedResults","reduce","acc","group","push","renderCard","index","label","Object","entries","find","_ref","k","v","includes","className","children","_ref2","onClick","type","placeholder","value","onChange","e","target","keys","length","_ref3","items","cat","i"],"sources":["C:/Users/admin/OneDrive - Impala Downtown/Documents/IDT - Web/frontend/src/components/PartsCategoriesPage.jsx"],"sourcesContent":["import React, { useState, useEffect, useMemo } from 'react';\r\nimport { FaCogs, FaTachometerAlt } from 'react-icons/fa';\r\n\r\nconst categories = [\r\n  { name: 'Engines', icon: <FaCogs /> },\r\n  { name: 'Service Parts', icon: <FaTachometerAlt /> },\r\n];\r\n\r\nconst apiRoutes = {\r\n  Engines: ['/api/engines'],\r\n  'Service Parts': ['/api/sparkplugs', '/api/filters'],\r\n};\r\n\r\nexport default function PartsCategoriesPage() {\r\n  const [selectedCategory, setSelectedCategory] = useState(null);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [debouncedSearchTerm, setDebouncedSearchTerm] = useState('');\r\n  const [results, setResults] = useState([]);\r\n\r\n  // Debounce search input\r\n  useEffect(() => {\r\n    const timeout = setTimeout(() => {\r\n      setDebouncedSearchTerm(searchTerm.trim());\r\n    }, 300);\r\n    return () => clearTimeout(timeout);\r\n  }, [searchTerm]);\r\n\r\n  // Fetch data only when category and search term are set\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      if (!selectedCategory || !debouncedSearchTerm) return;\r\n\r\n      const urls = apiRoutes[selectedCategory];\r\n      const params = new URLSearchParams({\r\n        q: debouncedSearchTerm,\r\n        page: 1,\r\n        page_size: 100,\r\n      });\r\n\r\n      try {\r\n        const responses = await Promise.all(\r\n          urls.map(url =>\r\n            fetch(`http://localhost:8000${url}?${params}`).then(async res => {\r\n              if (!res.ok) throw new Error(`Failed to fetch ${url}`);\r\n              const json = await res.json();\r\n              return json.results.map(item => ({\r\n                ...item,\r\n                sheet: item.sheet || url.split('/').pop(),\r\n              }));\r\n            })\r\n          )\r\n        );\r\n\r\n        setResults(responses.flat());\r\n      } catch (err) {\r\n        console.error('❌ Error fetching data:', err);\r\n        setResults([]);\r\n      }\r\n    };\r\n\r\n    fetchData();\r\n  }, [selectedCategory, debouncedSearchTerm]);\r\n\r\n  const groupedResults = useMemo(() => {\r\n    return results.reduce((acc, item) => {\r\n      const group = item.sheet || 'Other';\r\n      acc[group] = acc[group] || [];\r\n      acc[group].push(item);\r\n      return acc;\r\n    }, {});\r\n  }, [results]);\r\n\r\n  const renderCard = (item, index) => {\r\n    const label = Object.entries(item).find(\r\n      ([k, v]) => v && !['sheet', 'source', 'Qty', 'QTY', 'NOTE'].includes(k)\r\n    );\r\n\r\n    return (\r\n      <div\r\n        key={index}\r\n        className=\"bg-white rounded-2xl shadow hover:shadow-lg p-4 border border-gray-200\"\r\n      >\r\n        <h4 className=\"font-semibold text-blue-800 mb-2 text-md truncate\">\r\n          {label ? label[1] : 'Unnamed Part'}\r\n        </h4>\r\n        <ul className=\"text-sm text-gray-700 space-y-1\">\r\n          {Object.entries(item).map(([k, v]) =>\r\n            k !== 'sheet' && k !== 'source' && v ? (\r\n              <li key={k}>\r\n                <strong>{k}:</strong> {v}\r\n              </li>\r\n            ) : null\r\n          )}\r\n        </ul>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-gray-50 to-blue-100 py-10 px-6\">\r\n      <h1 className=\"text-4xl font-extrabold text-center mb-10 text-gray-900\">Browse Parts</h1>\r\n\r\n      {selectedCategory ? (\r\n        <div className=\"max-w-6xl mx-auto\">\r\n          <button\r\n            onClick={() => {\r\n              setSelectedCategory(null);\r\n              setSearchTerm('');\r\n              setResults([]);\r\n            }}\r\n            className=\"text-blue-600 hover:text-blue-800 font-semibold mb-6 flex items-center gap-2\"\r\n          >\r\n            ← Back to Categories\r\n          </button>\r\n\r\n          <input\r\n            type=\"text\"\r\n            placeholder=\"Search parts, model, make...\"\r\n            value={searchTerm}\r\n            onChange={e => setSearchTerm(e.target.value)}\r\n            className=\"w-full mb-8 p-3 rounded-lg border border-gray-300 shadow focus:outline-none focus:ring-2 focus:ring-blue-400\"\r\n          />\r\n\r\n          {Object.keys(groupedResults).length ? (\r\n            Object.entries(groupedResults).map(([sheet, items]) => (\r\n              <div key={sheet} className=\"mb-10\">\r\n                <h2 className=\"text-xl font-bold text-blue-700 mb-4 border-b pb-1 capitalize\">\r\n                  {sheet}\r\n                </h2>\r\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6\">\r\n                  {items.map(renderCard)}\r\n                </div>\r\n              </div>\r\n            ))\r\n          ) : (\r\n            debouncedSearchTerm && (\r\n              <p className=\"text-center text-gray-500 italic\">No matching parts found.</p>\r\n            )\r\n          )}\r\n        </div>\r\n      ) : (\r\n        <div className=\"max-w-7xl mx-auto grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-6\">\r\n          {categories.map((cat, i) => (\r\n            <button\r\n              key={i}\r\n              onClick={() => setSelectedCategory(cat.name)}\r\n              className=\"bg-white border border-gray-200 rounded-2xl p-6 flex flex-col items-center justify-center text-center shadow hover:shadow-lg transition hover:scale-105\"\r\n            >\r\n              <div className=\"text-4xl text-blue-500 mb-2\">{cat.icon}</div>\r\n              <span className=\"font-semibold text-sm text-gray-800\">{cat.name}</span>\r\n            </button>\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}